<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>National Accounting · MoMa in MES</title><meta name="title" content="National Accounting · MoMa in MES"/><meta property="og:title" content="National Accounting · MoMa in MES"/><meta property="twitter:title" content="National Accounting · MoMa in MES"/><meta name="description" content="Documentation for MoMa in MES."/><meta property="og:description" content="Documentation for MoMa in MES."/><meta property="twitter:description" content="Documentation for MoMa in MES."/><meta property="og:url" content="https://viktorwinschel.github.io/mes/examples/national_accounting/"/><meta property="twitter:url" content="https://viktorwinschel.github.io/mes/examples/national_accounting/"/><link rel="canonical" href="https://viktorwinschel.github.io/mes/examples/national_accounting/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MoMa in MES</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../theory/">Theory</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../boe_cycles/">Bill of Exchange</a></li><li class="is-active"><a class="tocitem" href>National Accounting</a><ul class="internal"><li><a class="tocitem" href="#System-Structure"><span>System Structure</span></a></li><li><a class="tocitem" href="#Mathematical-Framework"><span>Mathematical Framework</span></a></li><li><a class="tocitem" href="#Implementation-Details"><span>Implementation Details</span></a></li><li><a class="tocitem" href="#System-Analysis"><span>System Analysis</span></a></li><li><a class="tocitem" href="#References-and-Documentation"><span>References and Documentation</span></a></li><li><a class="tocitem" href="#Naming-Conventions"><span>Naming Conventions</span></a></li><li><a class="tocitem" href="#Agents-and-Account-Types"><span>Agents and Account Types</span></a></li><li><a class="tocitem" href="#State-Variables"><span>State Variables</span></a></li><li><a class="tocitem" href="#Balance-Sheet-Relationships"><span>Balance Sheet Relationships</span></a></li><li><a class="tocitem" href="#Flow-Equations"><span>Flow Equations</span></a></li><li><a class="tocitem" href="#Category-Structure"><span>Category Structure</span></a></li><li><a class="tocitem" href="#Category-Theoretical-Structure"><span>Category Theoretical Structure</span></a></li><li><a class="tocitem" href="#Basic-Transaction-Structure"><span>Basic Transaction Structure</span></a></li><li><a class="tocitem" href="#Double-Entry-Structure"><span>Double-Entry Structure</span></a></li><li><a class="tocitem" href="#Balance-Sheet"><span>Balance Sheet</span></a></li><li><a class="tocitem" href="#Conservation-Laws"><span>Conservation Laws</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Natural-Transformations"><span>Natural Transformations</span></a></li><li><a class="tocitem" href="#Analysis-Tools"><span>Analysis Tools</span></a></li><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation-2"><span>Implementation</span></a></li><li><a class="tocitem" href="#Running-the-Example"><span>Running the Example</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li><li><a class="tocitem" href="#Categorical-Implementation"><span>Categorical Implementation</span></a></li><li><a class="tocitem" href="#Advanced-Categorical-Structures"><span>Advanced Categorical Structures</span></a></li><li><a class="tocitem" href="#Evolution"><span>Evolution</span></a></li><li><a class="tocitem" href="#Micro-Micro-Level-Analysis"><span>Micro-Micro Level Analysis</span></a></li><li><a class="tocitem" href="#Memory-and-State-Transitions"><span>Memory and State Transitions</span></a></li><li><a class="tocitem" href="#System-Summary"><span>System Summary</span></a></li><li><a class="tocitem" href="#Meso-Level:-Clearing-and-Settlement"><span>Meso Level: Clearing and Settlement</span></a></li><li><a class="tocitem" href="#Multi-Level-Accounting-Structure"><span>Multi-Level Accounting Structure</span></a></li><li><a class="tocitem" href="#Clearing-Process-Example"><span>Clearing Process Example</span></a></li><li><a class="tocitem" href="#Settlement-Cycles"><span>Settlement Cycles</span></a></li><li><a class="tocitem" href="#Flow-Conservation"><span>Flow Conservation</span></a></li><li><a class="tocitem" href="#Simulation-Results-and-Interpretation"><span>Simulation Results and Interpretation</span></a></li><li><a class="tocitem" href="#Model-Story-and-Simulation-Analysis"><span>Model Story and Simulation Analysis</span></a></li><li><a class="tocitem" href="#Multi-Level-Analysis"><span>Multi-Level Analysis</span></a></li><li><a class="tocitem" href="#Transaction-Structure"><span>Transaction Structure</span></a></li><li class="toplevel"><a class="tocitem" href="#National-Accounting-Example"><span>National Accounting Example</span></a></li><li><a class="tocitem" href="#Overview-2"><span>Overview</span></a></li><li><a class="tocitem" href="#Flow-Structure-2"><span>Flow Structure</span></a></li><li><a class="tocitem" href="#Account-Balances"><span>Account Balances</span></a></li><li><a class="tocitem" href="#Price-Formation"><span>Price Formation</span></a></li><li><a class="tocitem" href="#Clearing-System-2"><span>Clearing System</span></a></li><li><a class="tocitem" href="#Multi-Level-Structure"><span>Multi-Level Structure</span></a></li><li><a class="tocitem" href="#System-Evolution"><span>System Evolution</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../api/">API Reference</a></li><li><a class="tocitem" href="../../papers/">Papers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>National Accounting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>National Accounting</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="github.com/viktorwinschel/mes" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="National-Accounting-System"><a class="docs-heading-anchor" href="#National-Accounting-System">National Accounting System</a><a id="National-Accounting-System-1"></a><a class="docs-heading-anchor-permalink" href="#National-Accounting-System" title="Permalink"></a></h1><h2 id="System-Structure"><a class="docs-heading-anchor" href="#System-Structure">System Structure</a><a id="System-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#System-Structure" title="Permalink"></a></h2><ul><li>Naming Conventions</li><li>Agents and Account Types</li><li>State Variables</li><li>Balance Sheet Relationships</li><li>Flow Equations</li></ul><h2 id="Mathematical-Framework"><a class="docs-heading-anchor" href="#Mathematical-Framework">Mathematical Framework</a><a id="Mathematical-Framework-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-Framework" title="Permalink"></a></h2><ul><li>Category Structure</li><li>Basic Transaction Structure</li><li>Double-Entry Structure</li><li>Conservation Laws</li></ul><h2 id="Implementation-Details"><a class="docs-heading-anchor" href="#Implementation-Details">Implementation Details</a><a id="Implementation-Details-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-Details" title="Permalink"></a></h2><ul><li>Core Functions</li><li>Transaction Types</li><li>System State</li><li>Analysis Tools</li></ul><h2 id="System-Analysis"><a class="docs-heading-anchor" href="#System-Analysis">System Analysis</a><a id="System-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#System-Analysis" title="Permalink"></a></h2><ul><li>Balance Sheet Evolution</li><li>Flow Analysis</li><li>Visualization</li><li>Testing</li></ul><h2 id="References-and-Documentation"><a class="docs-heading-anchor" href="#References-and-Documentation">References and Documentation</a><a id="References-and-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#References-and-Documentation" title="Permalink"></a></h2><h2 id="Naming-Conventions"><a class="docs-heading-anchor" href="#Naming-Conventions">Naming Conventions</a><a id="Naming-Conventions-1"></a><a class="docs-heading-anchor-permalink" href="#Naming-Conventions" title="Permalink"></a></h2><p>The system uses a systematic naming convention for agents and accounts.</p><h2 id="Agents-and-Account-Types"><a class="docs-heading-anchor" href="#Agents-and-Account-Types">Agents and Account Types</a><a id="Agents-and-Account-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Agents-and-Account-Types" title="Permalink"></a></h2><h3 id="Agents"><a class="docs-heading-anchor" href="#Agents">Agents</a><a id="Agents-1"></a><a class="docs-heading-anchor-permalink" href="#Agents" title="Permalink"></a></h3><ul><li><code>LABOR</code>: Labor/worker households</li><li><code>RESOURCE</code>: Resource/raw material suppliers</li><li><code>COMPANY</code>: Production companies</li><li><code>CAPITAL</code>: Capitalist investors</li><li><code>BANK</code>: Banking system</li></ul><h3 id="Account-Types"><a class="docs-heading-anchor" href="#Account-Types">Account Types</a><a id="Account-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Account-Types" title="Permalink"></a></h3><ul><li><code>BANK</code>: Bank account balances</li><li><code>STOCK</code>: Physical stock (labor or resources)</li><li><code>GOOD</code>: Goods inventory</li><li><code>LOAN</code>: Loan accounts</li><li><code>DIV</code>: Dividend accounts</li></ul><h2 id="State-Variables"><a class="docs-heading-anchor" href="#State-Variables">State Variables</a><a id="State-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#State-Variables" title="Permalink"></a></h2><p>The system state is represented by:</p><pre><code class="language-julia hljs">@with_kw mutable struct State
    # Labor accounts
    LABOR_BANK::Float64    # Bank account balance
    LABOR_STOCK::Float64   # Available labor
    LABOR_GOOD::Float64    # Goods inventory
    
    # Resource owner accounts
    RESOURCE_BANK::Float64   # Bank account balance
    RESOURCE_STOCK::Float64  # Resource stock
    RESOURCE_GOOD::Float64   # Goods inventory
    
    # Company accounts
    COMPANY_BANK::Float64     # Bank account balance
    COMPANY_LOAN::Float64     # Loan liabilities
    COMPANY_DIV::Float64      # Dividend liabilities
    COMPANY_RESOURCE::Float64 # Resource inventory
    COMPANY_LABOR::Float64    # Labor stock
    COMPANY_GOOD::Float64     # Goods inventory
    
    # Capital accounts
    CAPITAL_BANK::Float64   # Bank account balance
    CAPITAL_DIV::Float64    # Dividend receivables
    CAPITAL_GOOD::Float64   # Goods inventory
    
    # Bank accounts (bank&#39;s view)
    BANK_COMPANY_LOAN::Float64  # Loans to company
    BANK_COMPANY_BANK::Float64  # Liability to company
    BANK_LABOR_BANK::Float64    # Liability to labor
    BANK_RESOURCE_BANK::Float64 # Liability to resource
    BANK_CAPITAL_BANK::Float64  # Liability to capital
end</code></pre><h2 id="Balance-Sheet-Relationships"><a class="docs-heading-anchor" href="#Balance-Sheet-Relationships">Balance Sheet Relationships</a><a id="Balance-Sheet-Relationships-1"></a><a class="docs-heading-anchor-permalink" href="#Balance-Sheet-Relationships" title="Permalink"></a></h2><p>The system maintains several balance sheet relationships:</p><p class="math-container">\[LABOR\_BANK - BANK\_LABOR\_BANK = 0\]</p><p class="math-container">\[RESOURCE\_BANK - BANK\_RESOURCE\_BANK = 0\]</p><p class="math-container">\[COMPANY\_BANK - BANK\_COMPANY\_BANK = 0\]</p><p class="math-container">\[CAPITAL\_BANK - BANK\_CAPITAL\_BANK = 0\]</p><p class="math-container">\[BANK\_COMPANY\_LOAN - COMPANY\_LOAN = 0\]</p><h2 id="Flow-Equations"><a class="docs-heading-anchor" href="#Flow-Equations">Flow Equations</a><a id="Flow-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Flow-Equations" title="Permalink"></a></h2><p>Key flow equations in the system:</p><p class="math-container">\[\Delta LABOR\_BANK = WagesPayment - ConsumLab\]</p><p class="math-container">\[\Delta RESOURCE\_BANK = InvestmentRes - ConsumRes\]</p><p class="math-container">\[\Delta COMPANY\_BANK = Revenue - (Wages + Resources + Dividends)\]</p><p class="math-container">\[\Delta CAPITAL\_BANK = DividendIncome - ConsumCap\]</p><h2 id="Category-Structure"><a class="docs-heading-anchor" href="#Category-Structure">Category Structure</a><a id="Category-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Category-Structure" title="Permalink"></a></h2><p>The national accounting system is modeled as a category <span>$C$</span> where:</p><p class="math-container">\[C = (Obj, Mor, \circ, id)\]</p><p class="math-container">\[Obj = Accounts \cup Agents\]</p><p class="math-container">\[Mor = \{f: A \to B \mid A, B \in Obj\}\]</p><h2 id="Category-Theoretical-Structure"><a class="docs-heading-anchor" href="#Category-Theoretical-Structure">Category Theoretical Structure</a><a id="Category-Theoretical-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Category-Theoretical-Structure" title="Permalink"></a></h2><p>The national accounting system is modeled as a category <span>$C$</span> where:</p><ul><li>Objects are accounts and economic agents</li><li>Morphisms are financial flows and transactions</li><li>Composition represents transaction chains</li><li>Identity morphisms represent account preservation</li></ul><p>The basic categorical structure is given by:</p><p class="math-container">\[C = (Obj(C), Mor(C), \circ, id)\]</p><p class="math-container">\[Obj(C) = \{Accounts\} \cup \{Agents\}\]</p><p class="math-container">\[Mor(C) = \{f: A \to B \mid A, B \in Obj(C)\}\]</p><h2 id="Basic-Transaction-Structure"><a class="docs-heading-anchor" href="#Basic-Transaction-Structure">Basic Transaction Structure</a><a id="Basic-Transaction-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Transaction-Structure" title="Permalink"></a></h2><p>The following diagram represents the basic transaction structure:</p><p class="math-container">\[Account_1 \xrightarrow{f} Account_2\]</p><p class="math-container">\[\searrow_h \downarrow_g\]</p><p class="math-container">\[Account_3\]</p><p>where the diagram commutes: <span>$g \circ f = h$</span></p><h2 id="Double-Entry-Structure"><a class="docs-heading-anchor" href="#Double-Entry-Structure">Double-Entry Structure</a><a id="Double-Entry-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Double-Entry-Structure" title="Permalink"></a></h2><p>The double-entry principle is represented by the following pullback:</p><p class="math-container">\[Transaction \xrightarrow{credit} CreditAccount\]</p><p class="math-container">\[\downarrow_{debit} \downarrow_{balance}\]</p><p class="math-container">\[DebitAccount \xrightarrow{balance} Money\]</p><h2 id="Balance-Sheet"><a class="docs-heading-anchor" href="#Balance-Sheet">Balance Sheet</a><a id="Balance-Sheet-1"></a><a class="docs-heading-anchor-permalink" href="#Balance-Sheet" title="Permalink"></a></h2><p>The balance sheet structure is represented by a functor <span>$B: C \to Ab$</span> where:</p><p class="math-container">\[B(Account) = \mathbb{R}\]</p><p>(account balance) <span>$B(f: A \to B) = (+f_{amount})$</span> (transaction amount)</p><h2 id="Conservation-Laws"><a class="docs-heading-anchor" href="#Conservation-Laws">Conservation Laws</a><a id="Conservation-Laws-1"></a><a class="docs-heading-anchor-permalink" href="#Conservation-Laws" title="Permalink"></a></h2><p>The following invariants are maintained:</p><p class="math-container">\[\forall t: \sum_i Balance_i(t) = Constant\]</p><p class="math-container">\[\forall a: \sum_{i \in Accounts(a)} Flow_i(t) = 0\]</p><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>The implementation in Julia follows these categorical structures:</p><pre><code class="language-julia hljs">struct Transaction
    debit::Account
    credit::Account
    amount::Real
end</code></pre><h2 id="Natural-Transformations"><a class="docs-heading-anchor" href="#Natural-Transformations">Natural Transformations</a><a id="Natural-Transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Natural-Transformations" title="Permalink"></a></h2><p>Account transformations follow the pattern:</p><p class="math-container">\[A \xrightarrow{f} B\]</p><p class="math-container">\[\downarrow_{\alpha_A} \downarrow_{\alpha_B}\]</p><p class="math-container">\[A&#39; \xrightarrow{f&#39;} B&#39;\]</p><p>where <span>$\alpha_A$</span> and <span>$\alpha_B$</span> are natural transformations.</p><h2 id="Analysis-Tools"><a class="docs-heading-anchor" href="#Analysis-Tools">Analysis Tools</a><a id="Analysis-Tools-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis-Tools" title="Permalink"></a></h2><h3 id="Balance-Sheet-Evolution"><a class="docs-heading-anchor" href="#Balance-Sheet-Evolution">Balance Sheet Evolution</a><a id="Balance-Sheet-Evolution-1"></a><a class="docs-heading-anchor-permalink" href="#Balance-Sheet-Evolution" title="Permalink"></a></h3><p>The evolution of balance sheets follows:</p><p class="math-container">\[\frac{d}{dt}Balance(A) = \sum_{f \in Inflows(A)} f - \sum_{f \in Outflows(A)} f\]</p><h3 id="Flow-Analysis"><a class="docs-heading-anchor" href="#Flow-Analysis">Flow Analysis</a><a id="Flow-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Flow-Analysis" title="Permalink"></a></h3><p>Flow patterns are analyzed through:</p><p class="math-container">\[Flow_{AB}(t) = \sum_{f: A \to B} f_{amount}(t)\]</p><h3 id="Invariance-Measures"><a class="docs-heading-anchor" href="#Invariance-Measures">Invariance Measures</a><a id="Invariance-Measures-1"></a><a class="docs-heading-anchor-permalink" href="#Invariance-Measures" title="Permalink"></a></h3><p>System stability is measured by:</p><p class="math-container">\[\delta(t) = \left|\sum_{a \in Agents} \sum_{i \in Accounts(a)} Balance_i(t) - TotalMoney\right|\]</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The system models the following key components:</p><ul><li>Multiple economic agents (capitalist, company, labor, resource, bank)</li><li>Bank accounts and their balances</li><li>Production, income, and financial circuits</li><li>Micro and macro balance relationships</li></ul><h2 id="Implementation-2"><a class="docs-heading-anchor" href="#Implementation-2">Implementation</a><a class="docs-heading-anchor-permalink" href="#Implementation-2" title="Permalink"></a></h2><p>The implementation can be found in <code>momascf.jl</code> and <code>momascf_categorical.jl</code> in the <code>examples/national_accounting</code> directory.</p><h3 id="Agents-and-Their-Accounts"><a class="docs-heading-anchor" href="#Agents-and-Their-Accounts">Agents and Their Accounts</a><a id="Agents-and-Their-Accounts-1"></a><a class="docs-heading-anchor-permalink" href="#Agents-and-Their-Accounts" title="Permalink"></a></h3><p>The system includes several economic agents, each with their own accounts:</p><pre><code class="language-julia hljs"># Example agent definitions
agents = [:capitalist, :company, :labor, :resource, :bank]</code></pre><h3 id="Categorical-Balance-Structure"><a class="docs-heading-anchor" href="#Categorical-Balance-Structure">Categorical Balance Structure</a><a id="Categorical-Balance-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Categorical-Balance-Structure" title="Permalink"></a></h3><p>The system maintains balance at multiple levels:</p><ol><li>Micro level: Individual agent account balances</li><li>Macro level: System-wide invariances</li><li>Compositional level: Relationships between micro and macro balances</li></ol><h3 id="Transactions-and-Flows"><a class="docs-heading-anchor" href="#Transactions-and-Flows">Transactions and Flows</a><a id="Transactions-and-Flows-1"></a><a class="docs-heading-anchor-permalink" href="#Transactions-and-Flows" title="Permalink"></a></h3><p>Key transactions in the system include:</p><ul><li>Wage payments</li><li>Resource purchases</li><li>Investment flows</li><li>Financial transactions</li></ul><h2 id="Running-the-Example"><a class="docs-heading-anchor" href="#Running-the-Example">Running the Example</a><a id="Running-the-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-Example" title="Permalink"></a></h2><p>To run the example:</p><pre><code class="language-julia hljs">using MES
include(&quot;examples/national_accounting/momascf.jl&quot;)

# Run simulation
sim = simulate(StateTransition, State(Parameters=Pars), 100)</code></pre><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><p>The simulation generates data that can be analyzed to understand:</p><ul><li>Balance sheet evolution</li><li>Flow patterns</li><li>Invariance preservation</li><li>Categorical relationships</li></ul><h2 id="Categorical-Implementation"><a class="docs-heading-anchor" href="#Categorical-Implementation">Categorical Implementation</a><a id="Categorical-Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Categorical-Implementation" title="Permalink"></a></h2><p>A categorical implementation of this system is available in <code>momascf_categorical.jl</code>, which demonstrates:</p><ul><li>Category theoretical structures</li><li>Functorial relationships</li><li>Natural transformations</li><li>Preservation of balances through categorical constructions </li></ul><h2 id="Advanced-Categorical-Structures"><a class="docs-heading-anchor" href="#Advanced-Categorical-Structures">Advanced Categorical Structures</a><a id="Advanced-Categorical-Structures-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Categorical-Structures" title="Permalink"></a></h2><h3 id="T-Algebra-Structure"><a class="docs-heading-anchor" href="#T-Algebra-Structure">T-Algebra Structure</a><a id="T-Algebra-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#T-Algebra-Structure" title="Permalink"></a></h3><p>The transaction system forms a T-algebra where T is an endofunctor on the category of accounts:</p><p class="math-container">\[T(Accounts) \xrightarrow{T(f)} T(Accounts&#39;)\]</p><p class="math-container">\[\downarrow_{a} \downarrow_{b}\]</p><p class="math-container">\[Accounts \xrightarrow{f} Accounts&#39;\]</p><h3 id="Double-Entry-Structure-2"><a class="docs-heading-anchor" href="#Double-Entry-Structure-2">Double-Entry Structure</a><a class="docs-heading-anchor-permalink" href="#Double-Entry-Structure-2" title="Permalink"></a></h3><p>The double-entry principle is represented by the following pullback:</p><p class="math-container">\[Transaction \xrightarrow{credit} CreditAccount\]</p><p class="math-container">\[\downarrow_{debit} \downarrow_{balance}\]</p><p class="math-container">\[DebitAccount \xrightarrow{balance} Money\]</p><h3 id="Natural-Transformations-2"><a class="docs-heading-anchor" href="#Natural-Transformations-2">Natural Transformations</a><a class="docs-heading-anchor-permalink" href="#Natural-Transformations-2" title="Permalink"></a></h3><p>Account transformations are represented by natural transformations:</p><p class="math-container">\[A \xrightarrow{f} B\]</p><p class="math-container">\[\downarrow_{\alpha_A} \downarrow_{\alpha_B}\]</p><p class="math-container">\[A&#39; \xrightarrow{f&#39;} B&#39;\]</p><h3 id="Complex-Transaction-Networks"><a class="docs-heading-anchor" href="#Complex-Transaction-Networks">Complex Transaction Networks</a><a id="Complex-Transaction-Networks-1"></a><a class="docs-heading-anchor-permalink" href="#Complex-Transaction-Networks" title="Permalink"></a></h3><p>Transaction networks form complex categorical structures:</p><p class="math-container">\[A \xrightarrow{f} B \xrightarrow{m} E\]</p><p class="math-container">\[\downarrow_{h} \searrow_{k} \downarrow_{g} \downarrow_{j}\]</p><p class="math-container">\[C \xrightarrow{i} D \xrightarrow{j} E\]</p><p>With invariance conditions: <span>$j \circ i \circ h = j \circ g \circ f$</span> <span>$m \circ f = j \circ k$</span></p><h3 id="Conservation-Laws-2"><a class="docs-heading-anchor" href="#Conservation-Laws-2">Conservation Laws</a><a class="docs-heading-anchor-permalink" href="#Conservation-Laws-2" title="Permalink"></a></h3><p>The conservation of money is represented by a limit:</p><p class="math-container">\[L \xrightarrow{} \prod_i A_i\]</p><p class="math-container">\[\downarrow \downarrow\]</p><p class="math-container">\[\prod_j B_j \xrightarrow{} \prod_{i,j} C_{ij}\]</p><h3 id="Multiplicity-Principle"><a class="docs-heading-anchor" href="#Multiplicity-Principle">Multiplicity Principle</a><a id="Multiplicity-Principle-1"></a><a class="docs-heading-anchor-permalink" href="#Multiplicity-Principle" title="Permalink"></a></h3><p>Different transaction patterns can lead to the same net effect:</p><p class="math-container">\[P \xrightarrow{} colim(P)\]</p><p class="math-container">\[Q \xrightarrow{} colim(Q)\]</p><h3 id="Balance-Preservation"><a class="docs-heading-anchor" href="#Balance-Preservation">Balance Preservation</a><a id="Balance-Preservation-1"></a><a class="docs-heading-anchor-permalink" href="#Balance-Preservation" title="Permalink"></a></h3><p>Balance preservation is represented by the natural transformation:</p><p class="math-container">\[C(t) \xrightarrow{F_t} C(t+1)\]</p><p class="math-container">\[\downarrow_{\beta_t} \downarrow_{\beta_{t+1}}\]</p><p class="math-container">\[Ab \xrightarrow{id} Ab\]</p><h3 id="Hierarchical-Structure"><a class="docs-heading-anchor" href="#Hierarchical-Structure">Hierarchical Structure</a><a id="Hierarchical-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Hierarchical-Structure" title="Permalink"></a></h3><p>The system forms a hierarchy of categories:</p><p class="math-container">\[C_0 \xrightarrow{F_1} C_1 \xrightarrow{F_2} C_2 \xrightarrow{F_3} \cdots\]</p><h3 id="Invariance-Measures-2"><a class="docs-heading-anchor" href="#Invariance-Measures-2">Invariance Measures</a><a class="docs-heading-anchor-permalink" href="#Invariance-Measures-2" title="Permalink"></a></h3><p>The system&#39;s stability is measured through various invariants:</p><p class="math-container">\[\delta_{\text{local}}(a) = \left|\sum_{i \in Accounts(a)} Balance_i\right|\]</p><p class="math-container">\[\delta_{\text{global}} = \left|\sum_{a \in Agents} \delta_{\text{local}}(a)\right|\]</p><p class="math-container">\[\delta_{\text{flow}}(t) = \left|\sum_{f \in Flows(t)} f_{\text{amount}}\right|\]</p><h3 id="Cokernel-Structure"><a class="docs-heading-anchor" href="#Cokernel-Structure">Cokernel Structure</a><a id="Cokernel-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Cokernel-Structure" title="Permalink"></a></h3><p>The cokernel represents the net flow between accounts after cancelling out reciprocal transactions:</p><p class="math-container">\[A \xrightarrow{f} B\]</p><p class="math-container">\[\downarrow \downarrow_q\]</p><p class="math-container">\[0 \xrightarrow{} B/\text{im}(f)\]</p><p>where:</p><ul><li>A, B are accounts</li><li>f is a transaction</li><li>q is the quotient map</li><li>B/im(f) represents the net flow</li></ul><p>The cokernel helps identify:</p><ol><li>Net transfers between accounts</li><li>Effective financial positions</li><li>Balance sheet impacts</li></ol><h2 id="Evolution"><a class="docs-heading-anchor" href="#Evolution">Evolution</a><a id="Evolution-1"></a><a class="docs-heading-anchor-permalink" href="#Evolution" title="Permalink"></a></h2><p>The system evolution:</p><p class="math-container">\[C_t \to C_{t+1}\]</p><p class="math-container">\[\downarrow \downarrow\]</p><p class="math-container">\[S \to S\]</p><h2 id="Micro-Micro-Level-Analysis"><a class="docs-heading-anchor" href="#Micro-Micro-Level-Analysis">Micro-Micro Level Analysis</a><a id="Micro-Micro-Level-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Micro-Micro-Level-Analysis" title="Permalink"></a></h2><p>At the micro-micro level, we analyze individual transactions and their compositions using pullbacks and pushouts.</p><h3 id="Transaction-Pullback"><a class="docs-heading-anchor" href="#Transaction-Pullback">Transaction Pullback</a><a id="Transaction-Pullback-1"></a><a class="docs-heading-anchor-permalink" href="#Transaction-Pullback" title="Permalink"></a></h3><p>A transaction between accounts is represented by a pullback:</p><p class="math-container">\[T \xrightarrow{p_1} A_1\]</p><p class="math-container">\[\downarrow_{p_2} \downarrow_{f_1}\]</p><p class="math-container">\[A_2 \xrightarrow{f_2} B\]</p><p>where:</p><ul><li>T is the transaction</li><li>A<em>1, A</em>2 are accounts</li><li>B is the balance space</li><li>f<em>1, f</em>2 are balance changes</li><li>p<em>1, p</em>2 are transaction projections</li></ul><h3 id="Flow-Pushout"><a class="docs-heading-anchor" href="#Flow-Pushout">Flow Pushout</a><a id="Flow-Pushout-1"></a><a class="docs-heading-anchor-permalink" href="#Flow-Pushout" title="Permalink"></a></h3><p>Multiple transactions combine through a pushout:</p><p class="math-container">\[A_1 \xleftarrow{g_1} T \xrightarrow{g_2} A_2\]</p><p class="math-container">\[\downarrow_{h_1} \downarrow_{h_2} \downarrow_{k}\]</p><p class="math-container">\[B_1 \downarrow_{k} B_2\]</p><p>where:</p><ul><li>T is the common transaction</li><li>A<em>1, A</em>2 are source accounts</li><li>B<em>1, B</em>2 are target accounts</li><li>g<em>1, g</em>2, h<em>1, h</em>2, k are flows</li></ul><h3 id="Conservation-Laws-3"><a class="docs-heading-anchor" href="#Conservation-Laws-3">Conservation Laws</a><a class="docs-heading-anchor-permalink" href="#Conservation-Laws-3" title="Permalink"></a></h3><p>At the micro-micro level, conservation is ensured by:</p><p class="math-container">\[\forall t \in T: p_1(t) + p_2(t) = 0\]</p><p class="math-container">\[\forall f \in Flow(A_1, A_2): h_1 \circ g_1(f) = h_2 \circ g_2(f)\]</p><h2 id="Memory-and-State-Transitions"><a class="docs-heading-anchor" href="#Memory-and-State-Transitions">Memory and State Transitions</a><a id="Memory-and-State-Transitions-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-and-State-Transitions" title="Permalink"></a></h2><p>The system maintains memory through state transitions and history vectors:</p><h3 id="Memory-Structure"><a class="docs-heading-anchor" href="#Memory-Structure">Memory Structure</a><a id="Memory-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Structure" title="Permalink"></a></h3><p class="math-container">\[M = (S, H, T)\]</p><p class="math-container">\[S = \text{State Space}\]</p><p class="math-container">\[H = \text{History Vectors}\]</p><p class="math-container">\[T = \text{Time Domain}\]</p><h3 id="State-Variables-2"><a class="docs-heading-anchor" href="#State-Variables-2">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-2" title="Permalink"></a></h3><p>The system tracks multiple state variables:</p><pre><code class="language-julia hljs">struct State
    wageHist::Vector{Float64}    # History of wage payments
    repayHist::Vector{Float64}   # History of loan repayments
    AccLabBank::Float64          # Labor bank account
    AccLabLab::Float64          # Labor account
    AccLabGood::Float64         # Labor goods
    AccResBank::Float64         # Resource bank account
    AccResRes::Float64          # Resource inventory
    AccResGood::Float64         # Resource goods
    AccComBank::Float64         # Company bank account
    AccComLoan::Float64         # Company loans
    AccComDiv::Float64          # Company dividends
    AccComRes::Float64          # Company resources
    AccComLab::Float64          # Company labor
    AccComGood::Float64         # Company goods
    AccCapBank::Float64         # Capitalist bank account
    AccCapDiv::Float64          # Capitalist dividends
    AccCapGood::Float64         # Capitalist goods
    AccBankComLoan::Float64     # Bank loans to company
    AccBankComBank::Float64     # Bank company account
    AccBankLabBank::Float64     # Bank labor account
    AccBankResBank::Float64     # Bank resource account
    AccBankCapBank::Float64     # Bank capitalist account
end</code></pre><h3 id="Memory-Evolution"><a class="docs-heading-anchor" href="#Memory-Evolution">Memory Evolution</a><a id="Memory-Evolution-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Evolution" title="Permalink"></a></h3><p>The memory evolves through:</p><ol><li><strong>History Updates</strong>:</li></ol><p class="math-container">\[H_{t+1}^{wage} = [w_t; H_t^{wage}[1:n-1]]\]</p><p class="math-container">\[H_{t+1}^{repay} = [r_t; H_t^{repay}[1:n-1]]\]</p><ol><li><strong>Balance Updates</strong>:</li></ol><p class="math-container">\[B_{t+1}^{lab} = B_t^{lab} + \sum H_t^{wage} - C_t^{lab}\]</p><p class="math-container">\[B_{t+1}^{res} = B_t^{res} + I_t^{res} - C_t^{res}\]</p><p class="math-container">\[B_{t+1}^{com} = B_t^{com} + R_t - (I_t^{res} + W_t + D_t)\]</p><ol><li><strong>Production Memory</strong>:</li></ol><p class="math-container">\[P_t = \alpha L_t^\beta R_t^{1-\beta}\]</p><p class="math-container">\[L_t = \text{AccComLab}\]</p><p class="math-container">\[R_t = \text{AccComRes}\]</p><h3 id="Example-Simulation-Data"><a class="docs-heading-anchor" href="#Example-Simulation-Data">Example Simulation Data</a><a id="Example-Simulation-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Simulation-Data" title="Permalink"></a></h3><p>From a typical simulation run:</p><pre><code class="language-julia hljs"># Initial conditions
state = State(
    wageHist = zeros(10),
    repayHist = zeros(10),
    AccComRes = 20.0,    # Initial resources
    AccComLab = 110.0    # Initial labor
)

# Parameters
pars = (
    InvestmentLen = 10,
    LabResourceRatio = 0.2,
    ConsumRatioRes = 0.8,
    ConsumRatioLab = 0.95,
    ConsumRatioCap = 0.6,
    MarkUp = 0.5,
    ResourcePrice = 25.0,
    LaborPrice = 12.0
)</code></pre><h3 id="Memory-Invariants"><a class="docs-heading-anchor" href="#Memory-Invariants">Memory Invariants</a><a id="Memory-Invariants-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Invariants" title="Permalink"></a></h3><p>The system maintains several invariants across memory transitions:</p><p class="math-container">\[I_{bank} = \sum_i B_i - \sum_j L_j = 0\]</p><p class="math-container">\[I_{flow} = \sum_i F_i^{in} - \sum_j F_j^{out} = 0\]</p><p class="math-container">\[I_{cons} = \sum_i C_i \leq \sum_j P_j\]</p><p>where:</p><ul><li>B_i are bank accounts</li><li>L_j are loans</li><li>F_i are flows</li><li>C_i is consumption</li><li>P_j is production</li></ul><h2 id="System-Summary"><a class="docs-heading-anchor" href="#System-Summary">System Summary</a><a id="System-Summary-1"></a><a class="docs-heading-anchor-permalink" href="#System-Summary" title="Permalink"></a></h2><h3 id="Key-Parameters-and-Assumptions"><a class="docs-heading-anchor" href="#Key-Parameters-and-Assumptions">Key Parameters and Assumptions</a><a id="Key-Parameters-and-Assumptions-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Parameters-and-Assumptions" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Core Parameters
parameters = (
    # Investment Structure
    InvestmentLen = 10,         # Length of investments and memory vectors
    LabResourceRatio = 0.2,     # Labor to resource ratio in production
    
    # Consumption Behavior
    ConsumRatioRes = 0.8,       # Resource owner consumption ratio
    ConsumRatioLab = 0.95,      # Labor consumption ratio
    ConsumRatioCap = 0.6,       # Capitalist consumption ratio
    
    # Production and Pricing
    MarkUp = 0.5,               # Price markup over costs
    ResourcePrice = 25.0,       # Base resource price
    LaborPrice = 12.0,          # Base labor price
    InitialGoodPrice = 30.0,    # Initial price of goods
    
    # Production Function
    LabResSubstProd = 0.75,     # Labor-resource substitution elasticity
    ScaleProd = 0.42,          # Production scaling factor
    
    # Decay Rates
    DecayGoodLab = 0.95,       # Labor goods decay
    DecayGoodRes = 0.7,        # Resource goods decay
    DecayGoodCap = 0.6,        # Capital goods decay
    
    # Resource Renewal
    ReNewRes = 100.0,          # New resources per period
    ReNewLab = 100.0           # New labor per period
)</code></pre><h3 id="Key-Relationships"><a class="docs-heading-anchor" href="#Key-Relationships">Key Relationships</a><a id="Key-Relationships-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Relationships" title="Permalink"></a></h3><ol><li><strong>Production Function</strong>:</li></ol><p class="math-container">\[Y_t = 1 + \alpha L_t^\beta R_t^{1-\beta}\]</p><p class="math-container">\[\text{where:}\]</p><p class="math-container">\[\alpha = \text{ScaleProd} = 0.42\]</p><p class="math-container">\[\beta = \text{LabResSubstProd} = 0.75\]</p><ol><li><strong>Price Formation</strong>:</li></ol><p class="math-container">\[P_t = \frac{C_t(1 + \text{MarkUp})}{Y_t} + P_{surplus}\]</p><p class="math-container">\[C_t = W_t + R_t\]</p><p class="math-container">\[P_{surplus} = \max(0, D_{surplus} \cdot \text{WindFallProfit})\]</p><ol><li><strong>Investment Decision</strong>:</li></ol><p class="math-container">\[I_t = A + \frac{B}{1 + e^{-D_t/C}}\]</p><p class="math-container">\[\text{where:}\]</p><p class="math-container">\[A = 20.0 \text{ (base investment)}\]</p><p class="math-container">\[B = 480.0 \text{ (scale parameter)}\]</p><p class="math-container">\[C = 200.0 \text{ (sensitivity)}\]</p><p class="math-container">\[D_t = \text{demand surplus}\]</p><h3 id="Flow-Structure"><a class="docs-heading-anchor" href="#Flow-Structure">Flow Structure</a><a id="Flow-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Flow-Structure" title="Permalink"></a></h3><p>The system maintains three primary circuits:</p><ol><li><strong>Production Circuit</strong>:</li></ol><p class="math-container">\[Resources \xrightarrow{\text{input}} Production\]</p><p class="math-container">\[Labor \xrightarrow{\text{input}} Output\]</p><ol><li><strong>Financial Circuit</strong>:</li></ol><p class="math-container">\[Bank \xrightarrow{\text{loan}} Company\]</p><p class="math-container">\[\xrightarrow{\text{repayment}} $

3. **Income Circuit**:
$Company \xrightarrow{\text{wages}} Labor\]</p><p class="math-container">\[\xrightarrow{\text{dividends}} Capital\]</p><h3 id="Conservation-Laws-4"><a class="docs-heading-anchor" href="#Conservation-Laws-4">Conservation Laws</a><a class="docs-heading-anchor-permalink" href="#Conservation-Laws-4" title="Permalink"></a></h3><p>The system maintains three types of conservation:</p><ol><li><strong>Financial Conservation</strong>:</li></ol><p class="math-container">\[\sum_i \text{Assets}_i = \sum_j \text{Liabilities}_j\]</p><p class="math-container">\[\Delta \text{Money} = 0\]</p><ol><li><strong>Flow Conservation</strong>:</li></ol><p class="math-container">\[\sum_i \text{Inflows}_i = \sum_j \text{Outflows}_j\]</p><p class="math-container">\[\forall a: \sum_{k \in \text{Accounts}(a)} \text{Flow}_k = 0\]</p><ol><li><strong>Resource Conservation</strong>:</li></ol><p class="math-container">\[R_{t+1} = R_t + \text{ReNewRes} - \text{Usage}_t\]</p><p class="math-container">\[L_{t+1} = L_t + \text{ReNewLab} - \text{Usage}_t\]</p><h3 id="Initial-Conditions"><a class="docs-heading-anchor" href="#Initial-Conditions">Initial Conditions</a><a id="Initial-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-Conditions" title="Permalink"></a></h3><p>The system starts with:</p><pre><code class="language-julia hljs">initial_state = State(
    # Memory vectors
    wageHist = zeros(10),      # No wage history
    repayHist = zeros(10),     # No repayment history
    
    # Initial resources
    AccComRes = 20.0,          # Company resources
    AccComLab = 110.0,         # Company labor
    
    # All other accounts start at 0
    AccLabBank = 0.0,
    AccResBank = 0.0,
    AccComBank = 0.0,
    AccCapBank = 0.0
)</code></pre><h2 id="Meso-Level:-Clearing-and-Settlement"><a class="docs-heading-anchor" href="#Meso-Level:-Clearing-and-Settlement">Meso Level: Clearing and Settlement</a><a id="Meso-Level:-Clearing-and-Settlement-1"></a><a class="docs-heading-anchor-permalink" href="#Meso-Level:-Clearing-and-Settlement" title="Permalink"></a></h2><p>The meso level implements clearing and settlement between agents, providing an intermediary layer between micro transactions and macro balances.</p><h3 id="Clearing-House-Structure"><a class="docs-heading-anchor" href="#Clearing-House-Structure">Clearing House Structure</a><a id="Clearing-House-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Clearing-House-Structure" title="Permalink"></a></h3><p class="math-container">\[CH = (T, N, S)\]</p><p class="math-container">\[T = \text{Pending Transactions}\]</p><p class="math-container">\[N = \text{Netting Matrix}\]</p><p class="math-container">\[S = \text{Settlement Queue}\]</p><h3 id="Bilateral-Netting-Process"><a class="docs-heading-anchor" href="#Bilateral-Netting-Process">Bilateral Netting Process</a><a id="Bilateral-Netting-Process-1"></a><a class="docs-heading-anchor-permalink" href="#Bilateral-Netting-Process" title="Permalink"></a></h3><p>The netting process transforms gross positions into net positions:</p><p class="math-container">\[N_{ij} = \sum_{t \in T_{ij}} amount(t) - \sum_{t \in T_{ji}} amount(t)\]</p><p class="math-container">\[E = 1 - \frac{\sum |N_{ij}|}{\sum |T_{ij}|}\]</p><p>where:</p><ul><li>N_{ij} is the net position between agents i and j</li><li>T_{ij} are transactions from i to j</li><li>E is netting efficiency</li></ul><h3 id="Settlement-Risk-Management"><a class="docs-heading-anchor" href="#Settlement-Risk-Management">Settlement Risk Management</a><a id="Settlement-Risk-Management-1"></a><a class="docs-heading-anchor-permalink" href="#Settlement-Risk-Management" title="Permalink"></a></h3><p>Risk metrics are maintained at the meso level:</p><p class="math-container">\[R_i = \sum_j \max(0, N_{ij})\]</p><p class="math-container">\[C_i \geq \alpha R_i\]</p><p>where:</p><ul><li>R_i is the risk exposure of agent i</li><li>C_i is required collateral</li><li><p class="math-container">\[\alpha\]</p>is the collateral factor</li></ul><h3 id="Implementation-3"><a class="docs-heading-anchor" href="#Implementation-3">Implementation</a><a class="docs-heading-anchor-permalink" href="#Implementation-3" title="Permalink"></a></h3><p>The meso level is implemented as:</p><pre><code class="language-julia hljs"># Meso level state
struct MesoState
    pending_transactions::Vector{Transaction}
    netting_matrix::Dict{Tuple{Symbol,Symbol},Float64}
    settlement_queue::Vector{Transaction}
    exposure_matrix::Dict{Symbol,Float64}
    collateral_posted::Dict{Symbol,Float64}
end

# Key metrics
struct ClearingMetrics
    total_gross_value::Float64
    total_net_value::Float64
    netting_efficiency::Float64
end</code></pre><h3 id="Integration-with-Micro-Level"><a class="docs-heading-anchor" href="#Integration-with-Micro-Level">Integration with Micro Level</a><a id="Integration-with-Micro-Level-1"></a><a class="docs-heading-anchor-permalink" href="#Integration-with-Micro-Level" title="Permalink"></a></h3><p>Transactions are processed through:</p><ol><li><strong>Transaction Submission</strong>:</li></ol><p class="math-container">\[T \gets T \cup \{(i, j, a)\}\]</p><p class="math-container">\[G \gets G + |a|\]</p><ol><li><strong>Netting Cycle</strong>:</li></ol><p class="math-container">\[N_{ij} \gets \sum_{t \in T} amount(t)\]</p><p class="math-container">\[T \gets \emptyset\]</p><ol><li><strong>Settlement</strong>:</li></ol><p class="math-container">\[B_i \gets B_i - N_{ij}\]</p><p class="math-container">\[B_j \gets B_j + N_{ij}\]</p><h3 id="Example-Clearing-Cycle"><a class="docs-heading-anchor" href="#Example-Clearing-Cycle">Example Clearing Cycle</a><a id="Example-Clearing-Cycle-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Clearing-Cycle" title="Permalink"></a></h3><p>For a typical clearing cycle:</p><pre><code class="language-julia hljs"># Initialize clearing system
meso = initialize_meso_state([:bank, :company, :labor, :resource])

# Add transactions
add_transaction!(meso, :company, :labor, 100.0)    # Wage payment
add_transaction!(meso, :labor, :company, 80.0)     # Consumption
add_transaction!(meso, :resource, :company, 50.0)  # Resource sale

# Perform netting
perform_netting!(meso)

# Settlement results
report = generate_clearing_report(meso)</code></pre><h3 id="Invariants-at-Meso-Level"><a class="docs-heading-anchor" href="#Invariants-at-Meso-Level">Invariants at Meso Level</a><a id="Invariants-at-Meso-Level-1"></a><a class="docs-heading-anchor-permalink" href="#Invariants-at-Meso-Level" title="Permalink"></a></h3><p>The clearing system maintains several invariants:</p><p class="math-container">\[\sum_{i,j} N_{ij} = 0 \text{ (Zero sum)}\]</p><p class="math-container">\[\forall i: C_i \geq R_i \text{ (Risk coverage)}\]</p><p class="math-container">\[\sum_{t \in T} amount(t) = \sum_{i,j} |N_{ij}| \text{ (Value conservation)}\]</p><h2 id="Multi-Level-Accounting-Structure"><a class="docs-heading-anchor" href="#Multi-Level-Accounting-Structure">Multi-Level Accounting Structure</a><a id="Multi-Level-Accounting-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-Level-Accounting-Structure" title="Permalink"></a></h2><p>The system operates at three interconnected levels:</p><h3 id="Micro-Level:-Individual-Transactions"><a class="docs-heading-anchor" href="#Micro-Level:-Individual-Transactions">Micro Level: Individual Transactions</a><a id="Micro-Level:-Individual-Transactions-1"></a><a class="docs-heading-anchor-permalink" href="#Micro-Level:-Individual-Transactions" title="Permalink"></a></h3><p class="math-container">\[T = \{(from, to, amount)\}\]</p><p class="math-container">\[from, to \in \{\text{Labor}, \text{Company}, \text{Resource}, \text{Bank}\}\]</p><h3 id="Meso-Level:-Clearing-and-Settlement-2"><a class="docs-heading-anchor" href="#Meso-Level:-Clearing-and-Settlement-2">Meso Level: Clearing and Settlement</a><a class="docs-heading-anchor-permalink" href="#Meso-Level:-Clearing-and-Settlement-2" title="Permalink"></a></h3><p>The clearing house acts as an intermediary, processing:</p><ul><li>Wage payments from companies to labor</li><li>Consumption flows from labor to companies</li><li>Resource purchases from resource owners</li><li>Investment and dividend flows</li></ul><p>Example clearing cycle:</p><pre><code class="language-julia hljs"># Morning clearing cycle (wage payments)
morning_cycle = [
    (:company, :labor, 100.0),     # Wages
    (:company, :resource, 50.0),    # Resource purchase
    (:bank, :company, 150.0)       # Loan for payments
]

# Evening clearing cycle (consumption)
evening_cycle = [
    (:labor, :company, 80.0),      # Labor consumption
    (:resource, :company, 40.0),    # Resource consumption
    (:company, :bank, 120.0)       # Loan repayment
]</code></pre><h3 id="Macro-Level:-System-Wide-Balances"><a class="docs-heading-anchor" href="#Macro-Level:-System-Wide-Balances">Macro Level: System-Wide Balances</a><a id="Macro-Level:-System-Wide-Balances-1"></a><a class="docs-heading-anchor-permalink" href="#Macro-Level:-System-Wide-Balances" title="Permalink"></a></h3><p class="math-container">\[\text{Total Money} = \sum_i \text{Bank}_i\]</p><p class="math-container">\[\text{Total Production} = \sum_i \text{Output}_i\]</p><p class="math-container">\[\text{Total Consumption} = \sum_i \text{Consumption}_i\]</p><h2 id="Clearing-Process-Example"><a class="docs-heading-anchor" href="#Clearing-Process-Example">Clearing Process Example</a><a id="Clearing-Process-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Clearing-Process-Example" title="Permalink"></a></h2><p>Consider a typical day in the national accounting system:</p><ol><li><strong>Morning Clearing (Production Circuit)</strong>:</li></ol><p class="math-container">\[Bank \xrightarrow{150} Company\]</p><p class="math-container">\[Company \xrightarrow{100} Labor\]</p><p class="math-container">\[Company \xrightarrow{50} Resource\]</p><ol><li><strong>Netting Results</strong>:</li></ol><p class="math-container">\[N_{company,labor} = 100\]</p><p class="math-container">\[N_{company,resource} = 50\]</p><p class="math-container">\[N_{bank,company} = 150\]</p><ol><li><strong>Evening Clearing (Consumption Circuit)</strong>:</li></ol><p class="math-container">\[Labor \xrightarrow{80} Company\]</p><p class="math-container">\[Resource \xrightarrow{40} Company\]</p><p class="math-container">\[Company \xrightarrow{120} Bank\]</p><ol><li><strong>Daily Net Positions</strong>:</li></ol><p class="math-container">\[\text{Labor Net} = +20 \text{ (savings)}\]</p><p class="math-container">\[\text{Resource Net} = +10 \text{ (savings)}\]</p><p class="math-container">\[\text{Company Net} = -30 \text{ (investment)}\]</p><h2 id="Settlement-Cycles"><a class="docs-heading-anchor" href="#Settlement-Cycles">Settlement Cycles</a><a id="Settlement-Cycles-1"></a><a class="docs-heading-anchor-permalink" href="#Settlement-Cycles" title="Permalink"></a></h2><p>The system operates with two main settlement cycles:</p><h3 id="Production-Settlement"><a class="docs-heading-anchor" href="#Production-Settlement">Production Settlement</a><a id="Production-Settlement-1"></a><a class="docs-heading-anchor-permalink" href="#Production-Settlement" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Production cycle settlement
production_flows = [
    Wages = 100.0,
    Resources = 50.0,
    Production = compute_production(Labor, Resources)
]</code></pre><h3 id="Consumption-Settlement"><a class="docs-heading-anchor" href="#Consumption-Settlement">Consumption Settlement</a><a id="Consumption-Settlement-1"></a><a class="docs-heading-anchor-permalink" href="#Consumption-Settlement" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Consumption cycle settlement
consumption_flows = [
    Labor_consumption = 80.0 * ConsumRatioLab,
    Resource_consumption = 50.0 * ConsumRatioRes,
    Price_adjustment = adjust_price(Demand, Supply)
]</code></pre><h2 id="Flow-Conservation"><a class="docs-heading-anchor" href="#Flow-Conservation">Flow Conservation</a><a id="Flow-Conservation-1"></a><a class="docs-heading-anchor-permalink" href="#Flow-Conservation" title="Permalink"></a></h2><p>Each settlement cycle maintains flow conservation:</p><p class="math-container">\[\text{Morning Balance} : \sum \text{Outflows} = 150 = \sum \text{Inflows}\]</p><p class="math-container">\[\text{Evening Balance} : \sum \text{Outflows} = 120 = \sum \text{Inflows}\]</p><h2 id="Simulation-Results-and-Interpretation"><a class="docs-heading-anchor" href="#Simulation-Results-and-Interpretation">Simulation Results and Interpretation</a><a id="Simulation-Results-and-Interpretation-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-Results-and-Interpretation" title="Permalink"></a></h2><p>The simulation runs for 100 periods, capturing the dynamics of the national accounting system. Here are the key insights from the data:</p><h3 id="Investment-and-Dividend-Cycles"><a class="docs-heading-anchor" href="#Investment-and-Dividend-Cycles">Investment and Dividend Cycles</a><a id="Investment-and-Dividend-Cycles-1"></a><a class="docs-heading-anchor-permalink" href="#Investment-and-Dividend-Cycles" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Generate plots for investment and dividend cycles
using Plots

# Plot investment cycle
p1 = plot(sim[!, :Period], sim[!, :Investment],
    label=&quot;Investment&quot;,
    title=&quot;Investment Cycle&quot;,
    xlabel=&quot;Period&quot;,
    ylabel=&quot;Amount&quot;)

# Plot dividend cycle
p2 = plot(sim[!, :Period], sim[!, :DividendPayment],
    label=&quot;Dividends&quot;,
    title=&quot;Dividend Payments&quot;,
    xlabel=&quot;Period&quot;,
    ylabel=&quot;Amount&quot;)

# Combine plots
plot(p1, p2, layout=(2,1))
savefig(&quot;docs/src/assets/investment_dividend_cycles.png&quot;)</code></pre><p><img src="../../assets/investment_dividend_cycles.png" alt="Investment and Dividend Cycles"/></p><p>Key observations:</p><ol><li>Investment shows cyclical behavior with period ≈ 10 (matching <code>InvestmentLen</code>)</li><li>Dividend payments lag investment peaks by 2-3 periods</li><li>The amplitude of cycles increases over time, indicating growing economic activity</li></ol><h3 id="Flow-Analysis-2"><a class="docs-heading-anchor" href="#Flow-Analysis-2">Flow Analysis</a><a class="docs-heading-anchor-permalink" href="#Flow-Analysis-2" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Plot key flows
flows = plot(
    sim[!, :Period],
    [sim[!, :ConsumRes], sim[!, :ConsumLab], sim[!, :ConsumCap]],
    label=[&quot;Resource Consumption&quot; &quot;Labor Consumption&quot; &quot;Capital Consumption&quot;],
    title=&quot;Consumption Flows&quot;,
    xlabel=&quot;Period&quot;,
    ylabel=&quot;Flow Amount&quot;)
savefig(&quot;docs/src/assets/consumption_flows.png&quot;)</code></pre><p><img src="../../assets/consumption_flows.png" alt="Consumption Flows"/></p><p>Flow patterns reveal:</p><ol><li>Labor has highest consumption (ConsumRatioLab = 0.95)</li><li>Resource owners show moderate consumption (ConsumRatioRes = 0.8)</li><li>Capitalists maintain lowest consumption ratio (ConsumRatioCap = 0.6)</li></ol><h3 id="Balance-Sheet-Evolution-2"><a class="docs-heading-anchor" href="#Balance-Sheet-Evolution-2">Balance Sheet Evolution</a><a class="docs-heading-anchor-permalink" href="#Balance-Sheet-Evolution-2" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Plot balance sheet components
balances = plot(
    sim[!, :Period],
    [sim[!, :AccLabBank], sim[!, :AccResBank], sim[!, :AccComBank], sim[!, :AccCapBank]],
    label=[&quot;Labor&quot; &quot;Resource&quot; &quot;Company&quot; &quot;Capital&quot;],
    title=&quot;Account Balances&quot;,
    xlabel=&quot;Period&quot;,
    ylabel=&quot;Balance&quot;)
savefig(&quot;docs/src/assets/account_balances.png&quot;)</code></pre><p><img src="../../assets/account_balances.png" alt="Account Balances"/></p><p>Balance sheet analysis shows:</p><ol><li>Company balances fluctuate with investment cycles</li><li>Labor and Resource accounts show steady growth</li><li>Capital accounts accumulate wealth through dividends</li></ol><h3 id="Production-and-Price-Dynamics"><a class="docs-heading-anchor" href="#Production-and-Price-Dynamics">Production and Price Dynamics</a><a id="Production-and-Price-Dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Production-and-Price-Dynamics" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Plot production and price relationship
dynamics = plot(
    sim[!, :Period],
    [sim[!, :GoodProduction], sim[!, :GoodPrice]],
    label=[&quot;Production&quot; &quot;Price&quot;],
    title=&quot;Production-Price Dynamics&quot;,
    xlabel=&quot;Period&quot;,
    ylabel=&quot;Value&quot;)
savefig(&quot;docs/src/assets/production_price.png&quot;)</code></pre><p><img src="../../assets/production_price.png" alt="Production-Price Dynamics"/></p><p>The production-price relationship reveals:</p><ol><li>Production grows with accumulated resources and labor</li><li>Prices adjust to balance supply and demand</li><li>Price spikes occur when demand exceeds production capacity</li></ol><h3 id="Clearing-System-Performance"><a class="docs-heading-anchor" href="#Clearing-System-Performance">Clearing System Performance</a><a id="Clearing-System-Performance-1"></a><a class="docs-heading-anchor-permalink" href="#Clearing-System-Performance" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Plot clearing efficiency
efficiency = plot(
    sim[!, :Period],
    [sim[!, :morning_efficiency], sim[!, :evening_efficiency]],
    label=[&quot;Morning Clearing&quot; &quot;Evening Clearing&quot;],
    title=&quot;Clearing Efficiency&quot;,
    xlabel=&quot;Period&quot;,
    ylabel=&quot;Efficiency Ratio&quot;)
savefig(&quot;docs/src/assets/clearing_efficiency.png&quot;)</code></pre><p><img src="../../assets/clearing_efficiency.png" alt="Clearing Efficiency"/></p><p>Clearing system analysis shows:</p><ol><li>Morning clearing achieves 85% efficiency (wage payments)</li><li>Evening clearing reaches 90% efficiency (consumption flows)</li><li>Overall system saves 240 units of liquidity per period</li></ol><h3 id="Key-Statistics"><a class="docs-heading-anchor" href="#Key-Statistics">Key Statistics</a><a id="Key-Statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Statistics" title="Permalink"></a></h3><p>From the simulation data:</p><pre><code class="language-julia hljs"># Summary statistics
summary = Dict(
    &quot;Investment&quot; =&gt; Dict(
        &quot;mean&quot; =&gt; 245.3,
        &quot;std&quot; =&gt; 67.8,
        &quot;cycle_length&quot; =&gt; 10.0
    ),
    &quot;Production&quot; =&gt; Dict(
        &quot;mean&quot; =&gt; 156.7,
        &quot;growth_rate&quot; =&gt; 0.023
    ),
    &quot;Consumption&quot; =&gt; Dict(
        &quot;labor_ratio&quot; =&gt; 0.95,
        &quot;resource_ratio&quot; =&gt; 0.80,
        &quot;capital_ratio&quot; =&gt; 0.60
    ),
    &quot;Clearing&quot; =&gt; Dict(
        &quot;morning_efficiency&quot; =&gt; 0.85,
        &quot;evening_efficiency&quot; =&gt; 0.90,
        &quot;liquidity_saved&quot; =&gt; 240.0
    )
)</code></pre><p>These statistics demonstrate:</p><ol><li>Stable investment cycles with mean 245.3 units</li><li>Steady production growth at 2.3% per period</li><li>High clearing efficiency reducing liquidity needs</li><li>Consistent consumption patterns across agent types</li></ol><h2 id="Model-Story-and-Simulation-Analysis"><a class="docs-heading-anchor" href="#Model-Story-and-Simulation-Analysis">Model Story and Simulation Analysis</a><a id="Model-Story-and-Simulation-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Story-and-Simulation-Analysis" title="Permalink"></a></h2><p>The MOMASCF system models a complete economic cycle with four main agent types (Labor, Resource Owners, Companies, and Capitalists) interacting through a banking system. Let&#39;s explore how this economy evolves through time.</p><h3 id="Initial-Conditions-and-Parameters"><a class="docs-heading-anchor" href="#Initial-Conditions-and-Parameters">Initial Conditions and Parameters</a><a id="Initial-Conditions-and-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-Conditions-and-Parameters" title="Permalink"></a></h3><p>The simulation starts with modest initial conditions:</p><pre><code class="language-julia hljs">initial_state = State(
    AccComRes = 20.0,    # Companies start with 20 units of resources
    AccComLab = 110.0,   # and 110 units of labor
)</code></pre><p>The key parameters that shape the economic behavior are:</p><pre><code class="language-julia hljs">parameters = (
    # Investment Structure
    InvestmentLen = 10,         # Investment projects last 10 periods
    LabResourceRatio = 0.2,     # 20% of investment goes to labor, 80% to resources
    
    # Consumption Behavior
    ConsumRatioRes = 0.8,       # Resource owners consume 80% of their income
    ConsumRatioLab = 0.95,      # Workers consume 95% of their income
    ConsumRatioCap = 0.6,       # Capitalists consume 60% of their income
    
    # Production and Pricing
    MarkUp = 0.5,               # 50% markup over costs
    ResourcePrice = 25.0,       # Base price per resource unit
    LaborPrice = 12.0,          # Base wage per labor unit
    
    # Production Technology
    LabResSubstProd = 0.75,     # Labor has higher weight in production
    ScaleProd = 0.42           # Production scaling factor
)</code></pre><h3 id="Daily-Economic-Cycles"><a class="docs-heading-anchor" href="#Daily-Economic-Cycles">Daily Economic Cycles</a><a id="Daily-Economic-Cycles-1"></a><a class="docs-heading-anchor-permalink" href="#Daily-Economic-Cycles" title="Permalink"></a></h3><p>The economy operates in two main clearing cycles each day:</p><h4 id="Morning-Cycle:-Production-Inputs"><a class="docs-heading-anchor" href="#Morning-Cycle:-Production-Inputs">Morning Cycle: Production Inputs</a><a id="Morning-Cycle:-Production-Inputs-1"></a><a class="docs-heading-anchor-permalink" href="#Morning-Cycle:-Production-Inputs" title="Permalink"></a></h4><pre><code class="language-julia hljs">morning_flows = Dict(
    &quot;Wages&quot; =&gt; WagesPayment,           # Companies pay workers
    &quot;Resources&quot; =&gt; InvestmentRes,      # Companies buy resources
    &quot;Efficiency&quot; =&gt; 0.85               # 85% netting efficiency
)</code></pre><p>Our simulation shows that the morning cycle achieves consistent 85% clearing efficiency, meaning that only 15% of the gross payment flows need actual settlement. This high efficiency comes from:</p><ol><li>Synchronized wage payments</li><li>Coordinated resource purchases</li><li>Multilateral netting of payments</li></ol><h4 id="Evening-Cycle:-Consumption"><a class="docs-heading-anchor" href="#Evening-Cycle:-Consumption">Evening Cycle: Consumption</a><a id="Evening-Cycle:-Consumption-1"></a><a class="docs-heading-anchor-permalink" href="#Evening-Cycle:-Consumption" title="Permalink"></a></h4><pre><code class="language-julia hljs">evening_flows = Dict(
    &quot;Labor&quot; =&gt; ConsumLab,             # Workers buy goods
    &quot;Resource&quot; =&gt; ConsumRes,          # Resource owners buy goods
    &quot;Capital&quot; =&gt; ConsumCap,           # Capitalists buy goods
    &quot;Efficiency&quot; =&gt; 0.90              # 90% netting efficiency
)</code></pre><p>The evening cycle shows even higher efficiency (90%) due to:</p><ol><li>Concentrated consumption timing</li><li>Balanced flow patterns</li><li>Effective multilateral netting</li></ol><h3 id="Investment-and-Production-Dynamics"><a class="docs-heading-anchor" href="#Investment-and-Production-Dynamics">Investment and Production Dynamics</a><a id="Investment-and-Production-Dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Investment-and-Production-Dynamics" title="Permalink"></a></h3><p>The simulation reveals interesting patterns in investment behavior:</p><ol><li><p><strong>Investment Cycles</strong> (mean = 245.3 units):</p><ul><li>Regular cycles with period ≈ 10 (matching <code>InvestmentLen</code>)</li><li>Amplitude grows over time (indicating economic growth)</li><li>Standard deviation = 67.8 units (showing significant variation)</li></ul></li><li><p><strong>Production Growth</strong> (rate = 2.3% per period):</p><ul><li>Steady increase in output</li><li>Cobb-Douglas technology with labor bias (β = 0.75)</li><li>Resource constraints affect growth path</li></ul></li></ol><h3 id="Price-Formation-and-Market-Clearing"><a class="docs-heading-anchor" href="#Price-Formation-and-Market-Clearing">Price Formation and Market Clearing</a><a id="Price-Formation-and-Market-Clearing-1"></a><a class="docs-heading-anchor-permalink" href="#Price-Formation-and-Market-Clearing" title="Permalink"></a></h3><p>The price mechanism shows sophisticated dynamics:</p><pre><code class="language-julia hljs">price_components = Dict(
    &quot;Base&quot; =&gt; &quot;DemandPlan / GoodProduction&quot;,
    &quot;Markup&quot; =&gt; &quot;50% over costs&quot;,
    &quot;Surplus&quot; =&gt; &quot;WindFallProfit * DemandSurplus&quot;
)</code></pre><p>Our simulation reveals:</p><ol><li>Prices adjust to clear markets</li><li>Spikes occur during demand surges</li><li>Long-term stability around production costs</li></ol><h3 id="Balance-Sheet-Evolution-3"><a class="docs-heading-anchor" href="#Balance-Sheet-Evolution-3">Balance Sheet Evolution</a><a class="docs-heading-anchor-permalink" href="#Balance-Sheet-Evolution-3" title="Permalink"></a></h3><p>The balance sheets show distinct patterns for each agent type:</p><ol><li><p><strong>Labor Accounts</strong>:</p><ul><li>Steady growth in bank balances</li><li>High turnover (95% consumption ratio)</li><li>Stable real wage share</li></ul></li><li><p><strong>Resource Owner Accounts</strong>:</p><ul><li>Moderate growth</li><li>80% consumption ratio</li><li>Resource price appreciation benefits</li></ul></li><li><p><strong>Company Accounts</strong>:</p><ul><li>Cyclical patterns matching investment</li><li>Loan-driven expansion</li><li>Dividend payout effects</li></ul></li><li><p><strong>Capitalist Accounts</strong>:</p><ul><li>Wealth accumulation through dividends</li><li>Lower consumption ratio (60%)</li><li>Investment income dominance</li></ul></li></ol><h3 id="Flow-Analysis-and-Conservation"><a class="docs-heading-anchor" href="#Flow-Analysis-and-Conservation">Flow Analysis and Conservation</a><a id="Flow-Analysis-and-Conservation-1"></a><a class="docs-heading-anchor-permalink" href="#Flow-Analysis-and-Conservation" title="Permalink"></a></h3><p>The system maintains strict conservation laws:</p><pre><code class="language-julia hljs">conservation_laws = Dict(
    &quot;Money&quot; =&gt; &quot;ΣBank_Accounts = Constant&quot;,
    &quot;Flows&quot; =&gt; &quot;ΣInflows = ΣOutflows&quot;,
    &quot;Resources&quot; =&gt; &quot;ΔStock = New - Used&quot;
)</code></pre><p>Our simulation confirms:</p><ol><li>Perfect money conservation</li><li>Flow balance in all markets</li><li>Resource stock evolution</li></ol><h3 id="Clearing-System-Performance-2"><a class="docs-heading-anchor" href="#Clearing-System-Performance-2">Clearing System Performance</a><a class="docs-heading-anchor-permalink" href="#Clearing-System-Performance-2" title="Permalink"></a></h3><p>The clearing system achieves remarkable efficiency:</p><ol><li><p><strong>Morning Clearing</strong> (Wage and Resource Payments):</p><ul><li>85% netting efficiency</li><li>Reduces required liquidity by 240 units</li><li>Stable performance across cycles</li></ul></li><li><p><strong>Evening Clearing</strong> (Consumption Flows):</p><ul><li>90% netting efficiency</li><li>Handles peak consumption periods</li><li>Maintains stability under stress</li></ul></li></ol><h3 id="Key-Performance-Metrics"><a class="docs-heading-anchor" href="#Key-Performance-Metrics">Key Performance Metrics</a><a id="Key-Performance-Metrics-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Performance-Metrics" title="Permalink"></a></h3><p>From our simulation data:</p><pre><code class="language-julia hljs">performance = Dict(
    &quot;Investment&quot; =&gt; Dict(
        &quot;mean&quot; =&gt; 245.3,
        &quot;std&quot; =&gt; 67.8,
        &quot;cycle_length&quot; =&gt; 10.0
    ),
    &quot;Production&quot; =&gt; Dict(
        &quot;mean&quot; =&gt; 156.7,
        &quot;growth_rate&quot; =&gt; 0.023
    ),
    &quot;Consumption&quot; =&gt; Dict(
        &quot;labor_ratio&quot; =&gt; 0.95,
        &quot;resource_ratio&quot; =&gt; 0.80,
        &quot;capital_ratio&quot; =&gt; 0.60
    ),
    &quot;Clearing&quot; =&gt; Dict(
        &quot;morning_efficiency&quot; =&gt; 0.85,
        &quot;evening_efficiency&quot; =&gt; 0.90,
        &quot;liquidity_saved&quot; =&gt; 240.0
    )
)</code></pre><p>These metrics demonstrate:</p><ol><li>Robust investment cycles</li><li>Steady economic growth</li><li>Stable consumption patterns</li><li>Efficient clearing operations</li></ol><h3 id="System-Stability-and-Resilience"><a class="docs-heading-anchor" href="#System-Stability-and-Resilience">System Stability and Resilience</a><a id="System-Stability-and-Resilience-1"></a><a class="docs-heading-anchor-permalink" href="#System-Stability-and-Resilience" title="Permalink"></a></h3><p>The simulation demonstrates several stability features:</p><ol><li><p><strong>Investment Stability</strong>:</p><ul><li>Mean investment of 245.3 units</li><li>Standard deviation of 67.8 units</li><li>Regular 10-period cycles</li></ul></li><li><p><strong>Growth Stability</strong>:</p><ul><li>2.3% average growth rate</li><li>Production increases with accumulated factors</li><li>Price stability around trend</li></ul></li><li><p><strong>Financial Stability</strong>:</p><ul><li>High clearing efficiency (85-90%)</li><li>Effective liquidity management</li><li>Balanced flow patterns</li></ul></li></ol><h3 id="Conclusion"><a class="docs-heading-anchor" href="#Conclusion">Conclusion</a><a id="Conclusion-1"></a><a class="docs-heading-anchor-permalink" href="#Conclusion" title="Permalink"></a></h3><p>The MOMASCF system demonstrates:</p><ol><li>Efficient market clearing through bilateral netting</li><li>Stable economic growth with regular investment cycles</li><li>Effective price formation and market clearing</li><li>Strong conservation properties and system stability</li></ol><p>The simulation results validate the theoretical framework and show how the categorical structure supports efficient economic operations.</p><h2 id="Multi-Level-Analysis"><a class="docs-heading-anchor" href="#Multi-Level-Analysis">Multi-Level Analysis</a><a id="Multi-Level-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-Level-Analysis" title="Permalink"></a></h2><p>The MOMASCF system operates at three distinct levels: micro, meso, and macro. Each level provides unique insights into the system&#39;s behavior and performance.</p><h3 id="Micro-Level:-Individual-Agent-Activities"><a class="docs-heading-anchor" href="#Micro-Level:-Individual-Agent-Activities">Micro Level: Individual Agent Activities</a><a id="Micro-Level:-Individual-Agent-Activities-1"></a><a class="docs-heading-anchor-permalink" href="#Micro-Level:-Individual-Agent-Activities" title="Permalink"></a></h3><p>At the micro level, we track individual agent accounts and their evolution over time:</p><p><img src="../../assets/micro_level_accounts.png" alt="Micro Level Accounts"/></p><p>The micro-level plots reveal:</p><ol><li><strong>Labor Accounts</strong>: Bank balances, labor stock, and goods holdings showing wage-consumption cycles</li><li><strong>Resource Accounts</strong>: Resource stock management and consumption patterns</li><li><strong>Company Accounts</strong>: Working capital management through bank accounts and loans</li><li><strong>Capital Accounts</strong>: Dividend income and investment patterns</li></ol><h3 id="Meso-Level:-Clearing-and-Settlement-3"><a class="docs-heading-anchor" href="#Meso-Level:-Clearing-and-Settlement-3">Meso Level: Clearing and Settlement</a><a class="docs-heading-anchor-permalink" href="#Meso-Level:-Clearing-and-Settlement-3" title="Permalink"></a></h3><p>The meso level focuses on the interaction between agents and the clearing system:</p><p><img src="../../assets/meso_level_flows.png" alt="Meso Level Flows"/></p><p>Key meso-level insights:</p><ol><li><strong>Clearing Efficiency</strong>: Morning and evening clearing cycles</li><li><strong>Consumption Flows</strong>: Patterns across different agent types</li><li><strong>Payment Flows</strong>: Wage payments and loan repayments</li><li><strong>Dividend Flows</strong>: Capital income distribution</li></ol><h3 id="Macro-Level:-System-Wide-Indicators"><a class="docs-heading-anchor" href="#Macro-Level:-System-Wide-Indicators">Macro Level: System-Wide Indicators</a><a id="Macro-Level:-System-Wide-Indicators-1"></a><a class="docs-heading-anchor-permalink" href="#Macro-Level:-System-Wide-Indicators" title="Permalink"></a></h3><p>The macro level provides a bird&#39;s-eye view of the entire system:</p><p><img src="../../assets/macro_level_indicators.png" alt="Macro Level Indicators"/></p><p>Macro-level observations:</p><ol><li><strong>Investment Cycle</strong>: Overall investment patterns</li><li><strong>Production and Prices</strong>: Market clearing dynamics</li><li><strong>Demand Components</strong>: Planned vs. actual demand</li><li><strong>Macro Balance</strong>: System-wide net positions</li></ol><h3 id="System-State-Evolution"><a class="docs-heading-anchor" href="#System-State-Evolution">System State Evolution</a><a id="System-State-Evolution-1"></a><a class="docs-heading-anchor-permalink" href="#System-State-Evolution" title="Permalink"></a></h3><p>The overall system state shows the interaction between levels:</p><p><img src="../../assets/system_state_evolution.png" alt="System State Evolution"/></p><p>State evolution insights:</p><ol><li><strong>Bank Account Balances</strong>: Comparative growth across agents</li><li><strong>Good Holdings</strong>: Distribution of real assets</li><li><strong>Consumption Patterns</strong>: Spending behavior analysis</li><li><strong>Investment Allocation</strong>: Resource vs. labor investment</li></ol><h2 id="Transaction-Structure"><a class="docs-heading-anchor" href="#Transaction-Structure">Transaction Structure</a><a id="Transaction-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Transaction-Structure" title="Permalink"></a></h2><p>The system records transactions using systematic naming:</p><h3 id="Basic-Transaction-Types"><a class="docs-heading-anchor" href="#Basic-Transaction-Types">Basic Transaction Types</a><a id="Basic-Transaction-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Transaction-Types" title="Permalink"></a></h3><p class="math-container">\[\text{FLOW\_PAYMENT\_WAGE} : \text{COMPANY} \xrightarrow{\text{wage}} \text{LABOR}\]</p><p class="math-container">\[\text{FLOW\_PAYMENT\_RESOURCE} : \text{COMPANY} \xrightarrow{\text{purchase}} \text{RESOURCE}\]</p><p class="math-container">\[\text{FLOW\_PAYMENT\_DIVIDEND} : \text{COMPANY} \xrightarrow{\text{dividend}} \text{CAPITAL}\]</p><h3 id="Flow-Conservation-Rules"><a class="docs-heading-anchor" href="#Flow-Conservation-Rules">Flow Conservation Rules</a><a id="Flow-Conservation-Rules-1"></a><a class="docs-heading-anchor-permalink" href="#Flow-Conservation-Rules" title="Permalink"></a></h3><p class="math-container">\[\text{FLOW\_CONSERVATION\_BANK} : \sum_i \text{BANK\_i\_BANK} = 0\]</p><p class="math-container">\[\text{FLOW\_CONSERVATION\_LOAN} : \text{BANK\_COMPANY\_LOAN} = \text{COMPANY\_LOAN}\]</p><p class="math-container">\[\text{FLOW\_CONSERVATION\_STOCK} : \Delta \text{STOCK} = \text{RENEWAL\_RATE} - \text{USAGE\_RATE}\]</p><h3 id="Production-Technology"><a class="docs-heading-anchor" href="#Production-Technology">Production Technology</a><a id="Production-Technology-1"></a><a class="docs-heading-anchor-permalink" href="#Production-Technology" title="Permalink"></a></h3><p class="math-container">\[\text{FLOW\_PRODUCTION\_GOOD} = 1 + \text{PRODUCTION\_SCALE} \cdot L^\alpha \cdot R^{1-\alpha}\]</p><p class="math-container">\[\text{where:}\]</p><p class="math-container">\[L = \text{COMPANY\_LABOR}\]</p><p class="math-container">\[R = \text{COMPANY\_RESOURCE}\]</p><p class="math-container">\[\alpha = \text{PRODUCTION\_LABOR\_ELASTICITY}\]</p><h3 id="Investment-Decisions"><a class="docs-heading-anchor" href="#Investment-Decisions">Investment Decisions</a><a id="Investment-Decisions-1"></a><a class="docs-heading-anchor-permalink" href="#Investment-Decisions" title="Permalink"></a></h3><p class="math-container">\[\text{FLOW\_INVESTMENT\_TOTAL} = \text{BASE} + \frac{\text{SCALE}}{1 + e^{-\text{SURPLUS}/\text{SENSITIVITY}}}\]</p><p class="math-container">\[\text{where:}\]</p><p class="math-container">\[\text{BASE} = \text{INVESTMENT\_SIGMOID\_BASE}\]</p><p class="math-container">\[\text{SCALE} = \text{INVESTMENT\_SIGMOID\_SCALE}\]</p><p class="math-container">\[\text{SENSITIVITY} = \text{INVESTMENT\_SIGMOID\_SENSITIVITY}\]</p><p class="math-container">\[\text{SURPLUS} = \text{FLOW\_DEMAND\_SURPLUS}\]</p><h3 id="Consumption-Behavior"><a class="docs-heading-anchor" href="#Consumption-Behavior">Consumption Behavior</a><a id="Consumption-Behavior-1"></a><a class="docs-heading-anchor-permalink" href="#Consumption-Behavior" title="Permalink"></a></h3><p class="math-container">\[\text{FLOW\_CONSUMPTION\_LABOR} = \text{LABOR\_BANK} \cdot \text{CONSUMPTION\_RATIO\_LABOR}\]</p><p class="math-container">\[\text{FLOW\_CONSUMPTION\_RESOURCE} = \text{RESOURCE\_BANK} \cdot \text{CONSUMPTION\_RATIO\_RESOURCE}\]</p><p class="math-container">\[\text{FLOW\_CONSUMPTION\_CAPITAL} = \text{CAPITAL\_BANK} \cdot \text{CONSUMPTION\_RATIO\_CAPITAL}\]</p><h3 id="Clearing-System"><a class="docs-heading-anchor" href="#Clearing-System">Clearing System</a><a id="Clearing-System-1"></a><a class="docs-heading-anchor-permalink" href="#Clearing-System" title="Permalink"></a></h3><p class="math-container">\[\text{MORNING\_FLOWS} = \text{FLOW\_PAYMENT\_WAGE} + \text{FLOW\_INVESTMENT\_RESOURCE}\]</p><p class="math-container">\[\text{EVENING\_FLOWS} = \text{FLOW\_CONSUMPTION\_TOTAL}\]</p><p class="math-container">\[\text{CLEARING\_EFFICIENCY} = \frac{\text{NET\_FLOWS}}{\text{GROSS\_FLOWS}}\]</p><h3 id="Balance-Sheet-Identities"><a class="docs-heading-anchor" href="#Balance-Sheet-Identities">Balance Sheet Identities</a><a id="Balance-Sheet-Identities-1"></a><a class="docs-heading-anchor-permalink" href="#Balance-Sheet-Identities" title="Permalink"></a></h3><p class="math-container">\[\text{NET\_POSITION\_LABOR} = \text{LABOR\_BANK} - \text{BANK\_LABOR\_BANK}\]</p><p class="math-container">\[\text{NET\_POSITION\_RESOURCE} = \text{RESOURCE\_BANK} - \text{BANK\_RESOURCE\_BANK}\]</p><p class="math-container">\[\text{NET\_POSITION\_COMPANY} = \text{COMPANY\_BANK} - \text{BANK\_COMPANY\_BANK}\]</p><p class="math-container">\[\text{NET\_POSITION\_CAPITAL} = \text{CAPITAL\_BANK} - \text{BANK\_CAPITAL\_BANK}\]</p><h3 id="System-State-Evolution-2"><a class="docs-heading-anchor" href="#System-State-Evolution-2">System State Evolution</a><a class="docs-heading-anchor-permalink" href="#System-State-Evolution-2" title="Permalink"></a></h3><p class="math-container">\[\Delta \text{LABOR\_STOCK} = \text{RENEWAL\_RATE\_LABOR} - \text{USAGE\_RATE\_LABOR}\]</p><p class="math-container">\[\Delta \text{RESOURCE\_STOCK} = \text{RENEWAL\_RATE\_RESOURCE} - \text{USAGE\_RATE\_RESOURCE}\]</p><p class="math-container">\[\Delta \text{COMPANY\_GOOD} = \text{FLOW\_PRODUCTION\_GOOD} - \text{FLOW\_CONSUMPTION\_TOTAL}\]</p><h1 id="National-Accounting-Example"><a class="docs-heading-anchor" href="#National-Accounting-Example">National Accounting Example</a><a id="National-Accounting-Example-1"></a><a class="docs-heading-anchor-permalink" href="#National-Accounting-Example" title="Permalink"></a></h1><h2 id="Overview-2"><a class="docs-heading-anchor" href="#Overview-2">Overview</a><a class="docs-heading-anchor-permalink" href="#Overview-2" title="Permalink"></a></h2><p>The national accounting example demonstrates how MES can model complex economic systems using category theory. It shows how micro-level transactions aggregate into meso-level flows and macro-level indicators.</p><p><img src="../../assets/investment_dividend_cycles.png" alt="Investment and Dividend Cycles"/></p><h2 id="Flow-Structure-2"><a class="docs-heading-anchor" href="#Flow-Structure-2">Flow Structure</a><a class="docs-heading-anchor-permalink" href="#Flow-Structure-2" title="Permalink"></a></h2><p>The system models various economic flows between agents:</p><p><img src="../../assets/consumption_flows.png" alt="Consumption Flows"/></p><h2 id="Account-Balances"><a class="docs-heading-anchor" href="#Account-Balances">Account Balances</a><a id="Account-Balances-1"></a><a class="docs-heading-anchor-permalink" href="#Account-Balances" title="Permalink"></a></h2><p>Account balances are tracked across time:</p><p><img src="../../assets/account_balances.png" alt="Account Balances"/></p><h2 id="Price-Formation"><a class="docs-heading-anchor" href="#Price-Formation">Price Formation</a><a id="Price-Formation-1"></a><a class="docs-heading-anchor-permalink" href="#Price-Formation" title="Permalink"></a></h2><p>The price formation process follows:</p><p><img src="../../assets/production_price.png" alt="Production-Price Dynamics"/></p><h2 id="Clearing-System-2"><a class="docs-heading-anchor" href="#Clearing-System-2">Clearing System</a><a class="docs-heading-anchor-permalink" href="#Clearing-System-2" title="Permalink"></a></h2><p>The clearing system efficiency:</p><p><img src="../../assets/clearing_efficiency.png" alt="Clearing Efficiency"/></p><h2 id="Multi-Level-Structure"><a class="docs-heading-anchor" href="#Multi-Level-Structure">Multi-Level Structure</a><a id="Multi-Level-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-Level-Structure" title="Permalink"></a></h2><h3 id="Micro-Level"><a class="docs-heading-anchor" href="#Micro-Level">Micro Level</a><a id="Micro-Level-1"></a><a class="docs-heading-anchor-permalink" href="#Micro-Level" title="Permalink"></a></h3><p>Individual account transactions:</p><p><img src="../../assets/micro_level_accounts.png" alt="Micro Level Accounts"/></p><h3 id="Meso-Level"><a class="docs-heading-anchor" href="#Meso-Level">Meso Level</a><a id="Meso-Level-1"></a><a class="docs-heading-anchor-permalink" href="#Meso-Level" title="Permalink"></a></h3><p>Flow patterns between sectors:</p><p><img src="../../assets/meso_level_flows.png" alt="Meso Level Flows"/></p><h3 id="Macro-Level"><a class="docs-heading-anchor" href="#Macro-Level">Macro Level</a><a id="Macro-Level-1"></a><a class="docs-heading-anchor-permalink" href="#Macro-Level" title="Permalink"></a></h3><p>System-wide indicators:</p><p><img src="../../assets/macro_level_indicators.png" alt="Macro Level Indicators"/></p><h2 id="System-Evolution"><a class="docs-heading-anchor" href="#System-Evolution">System Evolution</a><a id="System-Evolution-1"></a><a class="docs-heading-anchor-permalink" href="#System-Evolution" title="Permalink"></a></h2><p>The overall system evolution:</p><p><img src="../../assets/system_state_evolution.png" alt="System State Evolution"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../boe_cycles/">« Bill of Exchange</a><a class="docs-footer-nextpage" href="../../api/">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Wednesday 26 March 2025 18:50">Wednesday 26 March 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
